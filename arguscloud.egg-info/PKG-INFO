Metadata-Version: 2.4
Name: arguscloud
Version: 0.5.0
Summary: Multi-cloud security graph analytics
Author: Jeremy Laratro
License: CloudHound Non-Commercial License
        
        Copyright (c) 2025 Jeremy Laratro
        
        Permission is hereby granted, free of charge, to any person obtaining a copy
        of this software and associated documentation files (the "Software"), to use,
        copy, modify, and distribute the Software for non-commercial purposes only,
        subject to the following conditions:
        
        1. NON-COMMERCIAL USE ONLY
           The Software may only be used for personal, educational, research, or other
           non-commercial purposes. Commercial use of the Software is strictly prohibited
           without prior written permission from the copyright holder.
        
           "Commercial use" includes, but is not limited to:
           - Using the Software to provide paid services or products
           - Using the Software in a commercial enterprise environment
           - Incorporating the Software into commercial products
           - Using the Software for revenue-generating activities
        
        2. ATTRIBUTION
           The above copyright notice and this permission notice shall be included in all
           copies or substantial portions of the Software.
        
        3. NO WARRANTY
           THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
           IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
           FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
           AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
           LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
           OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
           SOFTWARE.
        
        4. COMMERCIAL LICENSING
           For commercial licensing inquiries, please contact the copyright holder.
        
Project-URL: Homepage, https://github.com/jeremylaratro/cloudhound
Project-URL: Documentation, https://github.com/jeremylaratro/cloudhound#readme
Project-URL: Repository, https://github.com/jeremylaratro/cloudhound.git
Project-URL: Issues, https://github.com/jeremylaratro/cloudhound/issues
Keywords: cloud,security,aws,gcp,azure,graph,attack-path
Classifier: Development Status :: 4 - Beta
Classifier: Environment :: Console
Classifier: Intended Audience :: Information Technology
Classifier: Intended Audience :: System Administrators
Classifier: License :: Other/Proprietary License
Classifier: Operating System :: OS Independent
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: Topic :: Security
Classifier: Topic :: System :: Systems Administration
Requires-Python: >=3.9
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: boto3>=1.28.0
Requires-Dist: flask>=2.3.0
Requires-Dist: flask-cors>=4.0.0
Requires-Dist: flask-openapi3>=3.0.0
Requires-Dist: neo4j>=5.0.0
Requires-Dist: PyJWT>=2.0.0
Requires-Dist: pydantic>=2.0.0
Requires-Dist: pydantic-settings>=2.0.0
Provides-Extra: dev
Requires-Dist: pytest>=7.0.0; extra == "dev"
Requires-Dist: pytest-cov>=4.0.0; extra == "dev"
Requires-Dist: pytest-mock>=3.0.0; extra == "dev"
Requires-Dist: black>=23.0.0; extra == "dev"
Requires-Dist: mypy>=1.0.0; extra == "dev"
Requires-Dist: ruff>=0.1.0; extra == "dev"
Requires-Dist: testcontainers>=3.0.0; extra == "dev"
Requires-Dist: moto>=4.0.0; extra == "dev"
Provides-Extra: prod
Requires-Dist: flask-limiter>=3.0.0; extra == "prod"
Requires-Dist: prometheus-client>=0.17.0; extra == "prod"
Requires-Dist: gunicorn>=21.0.0; extra == "prod"
Provides-Extra: gcp
Requires-Dist: google-cloud-resource-manager>=1.0.0; extra == "gcp"
Requires-Dist: google-cloud-iam>=2.0.0; extra == "gcp"
Requires-Dist: google-cloud-storage>=2.0.0; extra == "gcp"
Requires-Dist: google-cloud-compute>=1.0.0; extra == "gcp"
Provides-Extra: azure
Requires-Dist: azure-identity>=1.0.0; extra == "azure"
Requires-Dist: azure-mgmt-resource>=23.0.0; extra == "azure"
Requires-Dist: azure-mgmt-authorization>=4.0.0; extra == "azure"
Requires-Dist: azure-mgmt-storage>=21.0.0; extra == "azure"
Provides-Extra: all
Requires-Dist: arguscloud[azure,dev,gcp]; extra == "all"
Dynamic: license-file

# ArgusCloud

BloodHound-style graph analytics for multi-cloud environments. Collect, normalize, and visualize cloud resources, trust relationships, and attack paths.

![Graph View](demo/screenshot-graph.png)

## Features

- **Multi-Cloud Support**: Modular architecture for AWS (with GCP and Azure coming soon)
- **AWS Data Collection**: Enumerate IAM, S3, EC2, Lambda, EKS, RDS, and 30+ other AWS services
- **Graph Visualization**: Interactive graph showing trust relationships, permissions, and attack paths
- **Attack Path Analysis**: Automated detection of privilege escalation and lateral movement opportunities
- **Multiple Export Formats**: JSON, SARIF (for CI/CD integration), and standalone HTML reports
- **Neo4j Integration**: Store and query data using Cypher
- **API Authentication**: JWT and API key support for secure access
- **Offline Support**: Export bundles for air-gapped analysis

## Screenshots

### Graph View
Visualize organizational structure, trust relationships, and attack paths with severity-colored edges.

![Graph View](demo/screenshot-graph.png)

### Environment Summary
View object counts and details by type (Accounts, Roles, Users, S3 Buckets, etc.).

![Environment View](demo/screenshot-environment.png)

### Data Management
Import/export data, fetch from API, or load files directly for offline analysis.

![Data Management](demo/screenshot-data.png)

### Attack Paths
View detected security findings with severity levels, rules, and affected resources.

![Attack Paths](demo/screenshot-attacks.png)

### Settings
Configure API connection, graph layout algorithm, and appearance options.

![Settings](demo/screenshot-settings.png)

## Installation

```bash
# Clone the repository
git clone https://github.com/jeremylaratro/arguscloud.git
cd arguscloud

# Install with pip
pip install -e .

# Or install with optional dependencies
pip install -e ".[dev]"      # Development tools
pip install -e ".[gcp]"      # GCP support (coming soon)
pip install -e ".[azure]"    # Azure support (coming soon)

# (Optional) Start Neo4j
docker run -d --name neo4j \
  -p 7474:7474 -p 7687:7687 \
  -e NEO4J_AUTH=neo4j/letmein123 \
  neo4j:latest
```

## Usage

### Collect AWS Data

```bash
# Using default AWS profile
arguscloud collect --provider aws --output ./output

# Using specific profile and region
arguscloud collect --provider aws --profile myprofile --region us-east-1 --output ./output

# Collect specific services only
arguscloud collect --provider aws --services iam s3 ec2 lambda
```

### Normalize Data

```bash
# Generate nodes and edges from collected data
arguscloud normalize --input ./output
```

### Analyze for Attack Paths

```bash
# Run security rules
arguscloud analyze --input ./output

# Filter by severity
arguscloud analyze --input ./output --severity high
```

### Export Reports

```bash
# Export to JSON
arguscloud export --input ./output --format json --output report.json

# Export to SARIF (for GitHub/Azure DevOps)
arguscloud export --input ./output --format sarif --output findings.sarif

# Export to standalone HTML report
arguscloud export --input ./output --format html --output report.html
```

### Import to Neo4j

```bash
arguscloud import --input ./output --neo4j-uri bolt://localhost:7687 --neo4j-user neo4j --neo4j-password letmein123
```

### Start the API Server

```bash
# Start with authentication enabled
arguscloud serve --port 5000

# Start without authentication (development only)
arguscloud serve --port 5000 --no-auth

# Generate an API key
arguscloud keygen
```

### Start the UI

```bash
# Start the UI (in another terminal)
cd ui && python -m http.server 8001
```

Open http://localhost:8001 in your browser.

## Supported Services

| Category | Services |
|----------|----------|
| Identity | IAM (users, roles, policies), STS, SSO |
| Compute | EC2, Lambda, EKS, ECR |
| Storage | S3, RDS |
| Security | CloudTrail, GuardDuty, SecurityHub, Detective, WAF, Shield |
| Networking | VPC |
| Management | Organizations, CloudFormation, Config |
| Messaging | SNS, SQS |
| Secrets | Secrets Manager, SSM Parameters, KMS |
| CI/CD | CodeBuild, CodePipeline |
| Monitoring | CloudWatch |

## Attack Path Rules

ArgusCloud automatically detects potential attack paths including:

- **Privilege Escalation**: Users/roles that can escalate to admin
- **Cross-Account Access**: Trust relationships allowing lateral movement
- **Public Exposure**: S3 buckets, security groups with public access
- **Credential Access**: Roles with access to secrets or KMS keys

## Architecture

```
arguscloud/
├── core/
│   ├── graph.py       # Core data structures (Node, Edge, AttackPath)
│   ├── registry.py    # Plugin registries for collectors/normalizers/rules
│   └── base.py        # Base classes and utilities
├── collectors/
│   ├── aws/           # AWS service collectors (IAM, S3, EC2, etc.)
│   ├── gcp/           # GCP collectors (coming soon)
│   └── azure/         # Azure collectors (coming soon)
├── normalizers/
│   └── aws/           # AWS data normalizers
├── rules/
│   └── aws/           # AWS security rules (IAM, S3, EC2, etc.)
├── exporters/
│   ├── json_export.py # JSON report format
│   ├── sarif.py       # SARIF format for CI/CD
│   └── html.py        # Standalone HTML reports
├── api/
│   ├── server.py      # Flask REST API
│   └── auth.py        # JWT/API key authentication
└── cli/
    └── main.py        # Unified CLI interface

awshound/                # Legacy AWS-specific module
├── auth.py            # AWS authentication handling
├── collector.py       # Service data collection
├── normalize.py       # Convert raw data to graph nodes/edges
└── rules.py           # Attack path detection rules

ui/
└── index.html         # Web-based graph viewer
```

## Requirements

- Python 3.10+
- AWS credentials with read permissions
- Neo4j 4.x+ (optional, for persistence)

## License

This software is licensed for **non-commercial use only**. See [LICENSE](LICENSE) for details.

For commercial licensing inquiries, please contact the author.
